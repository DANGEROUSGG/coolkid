-- Create the ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MyGUI"
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Create the Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 300, 0, 350)
frame.Position = UDim2.new(0.5, -150, 0.5, -175)
frame.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
frame.Parent = screenGui
frame.Visible = true -- Make sure the frame is visible

-- Make the frame draggable
local dragging = false
local dragInput, dragStart, startPos

frame.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
    end
end)

frame.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

frame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- Create the Fly Button
local flyButton = Instance.new("TextButton")
flyButton.Size = UDim2.new(0, 150, 0, 50)
flyButton.Position = UDim2.new(0.5, -75, 0.7, -25)
flyButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
flyButton.Text = "Fly"
flyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
flyButton.Font = Enum.Font.SourceSans
flyButton.TextSize = 24
flyButton.BackgroundTransparency = 0.3  -- Make sure button is visible
flyButton.Parent = frame
flyButton.Visible = true -- Make sure the fly button is visible

-- Flying system
local player = game.Players.LocalPlayer
local mouse = player:GetMouse()
local character = player.Character or player.CharacterAdded:Wait()
local BV = Instance.new("BodyVelocity", character:WaitForChild("HumanoidRootPart"))
BV.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
BV.Velocity = Vector3.new(0, 0, 0)

local Bind = false
local SPEED = 100 -- Adjust speed for flying

-- Function to start flying
local function startFlying()
    BV.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
end

-- Function to stop flying
local function stopFlying()
    BV.MaxForce = Vector3.new(0, 0, 0)
end

-- Toggle flying with 'F' key
local UIS = game:GetService("UserInputService")
UIS.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.F and not Bind then
        Bind = true
        startFlying()
    elseif input.KeyCode == Enum.KeyCode.F and Bind then
        Bind = false
        stopFlying()
    end
end)

-- Update flying direction based on mouse movement
mouse.Move:Connect(function()
    if Bind then
        BV.Velocity = CFrame.new(character.HumanoidRootPart.Position, mouse.Hit.Position).LookVector * SPEED
    end
end)

-- Button click event for fly toggle
flyButton.MouseButton1Click:Connect(function()
    if Bind then
        stopFlying()
        Bind = false
    else
        startFlying()
        Bind = true
    end
end)

-- Create the Name Change TextBox
local nameTextBox = Instance.new("TextBox")
nameTextBox.Size = UDim2.new(0, 200, 0, 50)
nameTextBox.Position = UDim2.new(0.5, -100, 0.2, -25)
nameTextBox.PlaceholderText = "Enter new name"
nameTextBox.Text = ""
nameTextBox.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
nameTextBox.TextColor3 = Color3.fromRGB(0, 0, 0)
nameTextBox.Font = Enum.Font.SourceSans
nameTextBox.TextSize = 24
nameTextBox.Parent = frame
nameTextBox.Visible = true -- Make sure the text box is visible

-- Create the Change Name Button
local changeNameButton = Instance.new("TextButton")
changeNameButton.Size = UDim2.new(0, 150, 0, 50)
changeNameButton.Position = UDim2.new(0.5, -75, 0.4, 25)
changeNameButton.BackgroundColor3 = Color3.fromRGB(0, 0, 255)
changeNameButton.Text = "Change Name"
changeNameButton.TextColor3 = Color3.fromRGB(255, 255, 255)
changeNameButton.Font = Enum.Font.SourceSans
changeNameButton.TextSize = 24
changeNameButton.BackgroundTransparency = 0.3  -- Make sure button is visible
changeNameButton.Parent = frame
changeNameButton.Visible = true -- Make sure the change name button is visible

-- Function to change the player's name
local function changeName()
    local newName = nameTextBox.Text
    if newName ~= "" then
        game.Players.LocalPlayer.Name = newName
    end
end

-- Button click event for name change
changeNameButton.MouseButton1Click:Connect(function()
    changeName()
end)
